# Module: Detail (ì°¨ëŸ‰ ìƒì„¸)

> ê°œë³„ ì°¨ëŸ‰ì˜ ìƒì„¸ ì •ë³´ ì¡°íšŒ ë° ìˆ˜ì •

---

## ê°œìš”

ì°¨ëŸ‰ ìƒì„¸ í˜ì´ì§€ëŠ” íŠ¹ì • ì°¨ëŸ‰ì˜ ìƒì„¸ ì •ë³´ì™€ ì‹¤ì‹œê°„ ìœ„ì¹˜ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.

**ê²½ë¡œ:** `/detail?carNumber={carNumber}`
**íŒŒì¼:** [src/app/detail/page.tsx](../src/app/detail/page.tsx)

---

## ìŠ¤í¬ë¦°ìƒ·

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [TopBar]  2 the Core                    [AccountMenu]  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  [ì°¨ëŸ‰ ê²€ìƒ‰] [ì£¼í–‰ ê¸°ë¡] [ë°ì´í„° ë¶„ì„] [ì—ë®¬ë ˆì´í„°]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚ [â†] ì°¨ëŸ‰ ì •ë³´   â”‚  â”‚                                 â”‚
â”‚  â”‚                 â”‚  â”‚                                 â”‚
â”‚  â”‚ ì°¨ëŸ‰ ë²ˆí˜¸       â”‚  â”‚        Kakao Maps               â”‚
â”‚  â”‚ [12ê°€ 1234    ] â”‚  â”‚     (ê°œë³„ ì°¨ëŸ‰ ìœ„ì¹˜)             â”‚
â”‚  â”‚                 â”‚  â”‚                                 â”‚
â”‚  â”‚ ì°¨ëŸ‰ ë¸Œëœë“œ ì´ë¦„ â”‚  â”‚         ğŸ“                      â”‚
â”‚  â”‚ [í˜„ëŒ€ ì•„ë°˜ë–¼   ]â”‚  â”‚                                 â”‚
â”‚  â”‚                 â”‚  â”‚                                 â”‚
â”‚  â”‚ ìƒíƒœ           â”‚  â”‚                                 â”‚
â”‚  â”‚ [ìš´í–‰         ]â”‚  â”‚                                 â”‚
â”‚  â”‚                 â”‚  â”‚                                 â”‚
â”‚  â”‚ ì°¨ëŸ‰ ì—°ì‹      â”‚  â”‚                                 â”‚
â”‚  â”‚ [2023         ]â”‚  â”‚                                 â”‚
â”‚  â”‚                 â”‚  â”‚                                 â”‚
â”‚  â”‚ ì£¼í–‰ ê±°ë¦¬ (km) â”‚  â”‚                                 â”‚
â”‚  â”‚ [15000.50     ]â”‚  â”‚                                 â”‚
â”‚  â”‚                 â”‚  â”‚                                 â”‚
â”‚  â”‚ ì°¨ê¸‰           â”‚  â”‚                                 â”‚
â”‚  â”‚ [ì¤‘í˜•         ]â”‚  â”‚                                 â”‚
â”‚  â”‚                 â”‚  â”‚                                 â”‚
â”‚  â”‚ [í™•ì¸] [ì·¨ì†Œ]   â”‚  â”‚                                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

```mermaid
graph TD
    DetailPage["DetailPage"]

    DetailPage --> KakaoMapScript
    DetailPage --> Card["Card (ì°¨ëŸ‰ ì •ë³´)"]
    DetailPage --> CarLocationMap

    Card --> Input["Input x 6"]
    Card --> Button["Button (í™•ì¸/ì·¨ì†Œ)"]
```

---

## ì£¼ìš” ê¸°ëŠ¥

### 1. ì°¨ëŸ‰ ì •ë³´ í‘œì‹œ

| í•„ë“œ | ìƒíƒœ í‚¤ | í¸ì§‘ ê°€ëŠ¥ |
|------|---------|-----------|
| ì°¨ëŸ‰ ë²ˆí˜¸ | `carNumber` | âŒ |
| ë¸Œëœë“œ ì´ë¦„ | `brandModel` | âœ… |
| ìƒíƒœ | `status` | âœ… |
| ì°¨ëŸ‰ ì—°ì‹ | `carYear` | âœ… |
| ì£¼í–‰ ê±°ë¦¬ | `sumDist` | âœ… |
| ì°¨ê¸‰ | `carType` | âœ… |

### 2. ì‹¤ì‹œê°„ ìœ„ì¹˜ ê°±ì‹ 

3ì´ˆ ê°„ê²©ìœ¼ë¡œ ì°¨ëŸ‰ ìœ„ì¹˜ë¥¼ ìë™ ê°±ì‹ í•©ë‹ˆë‹¤.

```typescript
// src/app/detail/page.tsx:75-90
useEffect(() => {
  const intervalId = setInterval(async () => {
    const updatedCarDetail = await CarService.getCar(urlCarNumber);
    setDetail(updatedCarDetail);
  }, 3000);

  return () => clearInterval(intervalId);
}, [urlCarNumber]);
```

### 3. í¸ì§‘ ëª¨ë“œ

Zustand ìŠ¤í† ì–´ì˜ `detailChange` ìƒíƒœë¡œ í¸ì§‘ ëª¨ë“œë¥¼ ì œì–´í•©ë‹ˆë‹¤.

---

## ìƒíƒœ ê´€ë¦¬

### Zustand Store

#### useDetailStore

**íŒŒì¼:** [src/store/detail-store.ts](../src/store/detail-store.ts)

```typescript
type DetailStore = CarDetail & {
  setDetail: (detail: CarDetail) => void;
};

export const useDetailStore = create<DetailStore>(set => ({
  carNumber: '',
  brand: '',
  model: '',
  brandModel: '',
  status: '' as 'ìš´í–‰' | 'ëŒ€ê¸°' | 'ìˆ˜ë¦¬',
  lastLatitude: '',
  lastLongitude: '',
  carYear: 0,
  sumDist: 0,
  carType: '',
  setDetail: detail => set({
    ...detail,
    brandModel: `${detail.brand} ${detail.model}`,
    sumDist: detail.sumDist ? Number(detail.sumDist.toFixed(2)) : 0
  }),
}));
```

#### setDetailChangeStore

**íŒŒì¼:** [src/store/detail-change.ts](../src/store/detail-change.ts)

```typescript
interface DetailChangeStore {
  detailChange: boolean;
  setDetailChange: (value: boolean) => void;
}
```

### ì»´í¬ë„ŒíŠ¸ ìƒíƒœ ì‚¬ìš©

```typescript
// src/app/detail/page.tsx:20-35
const {
  carNumber, brand, model, status,
  carYear, sumDist, carType,
  setDetail, brandModel,
  lastLatitude, lastLongitude,
} = useDetailStore();

const detailChange = setDetailChangeStore(state => state.detailChange);
const setDetailChange = setDetailChangeStore(state => state.setDetailChange);
```

---

## ë°ì´í„° íë¦„

```mermaid
sequenceDiagram
    participant URL
    participant DetailPage
    participant CarService
    participant ZustandStore
    participant UI

    URL->>DetailPage: ?carNumber=12ê°€1234
    DetailPage->>CarService: getCar(carNumber)
    CarService-->>DetailPage: CarDetail
    DetailPage->>ZustandStore: setDetail(carDetail)
    ZustandStore-->>UI: í¼ í•„ë“œ ì—…ë°ì´íŠ¸

    loop 3ì´ˆë§ˆë‹¤
        DetailPage->>CarService: getCar(carNumber)
        CarService-->>ZustandStore: setDetail(updated)
        ZustandStore-->>UI: ì§€ë„ ë§ˆì»¤ ì—…ë°ì´íŠ¸
    end
```

---

## API í˜¸ì¶œ

### ì´ˆê¸° ë°ì´í„° ë¡œë“œ

```typescript
// src/app/detail/page.tsx:59-73
useEffect(() => {
  if (urlCarNumber) {
    const fetchCarDetail = async () => {
      const carDetail = await CarService.getCar(urlCarNumber);
      setDetail(carDetail);
    };
    fetchCarDetail();
  }
}, [urlCarNumber]);
```

### ì°¨ëŸ‰ ì •ë³´ ì €ì¥

```typescript
// src/app/detail/page.tsx:122-154
const handleSave = async () => {
  let [finalBrand, finalModel] = brandModel.split(' ');

  const updateData: Partial<CarDetail> = {
    brand: finalBrand,
    model: finalModel,
    status,
    carYear,
    sumDist,
    carType,
  };

  await CarService.updateCar(carNumber, updateData);
  setDetailChange(false);
  navigate('/search');
};
```

---

## í•„ë“œ ìˆ˜ì • í•¸ë“¤ëŸ¬

```typescript
// src/app/detail/page.tsx:92-120
const handleChange = (
  field: 'brandModel' | keyof CarDetail,
  value: string
) => {
  if (field === 'brandModel') {
    setDetail({
      carNumber, brand, brandModel: value, model, status,
      carYear, sumDist, carType,
    });
  } else {
    setDetail({
      carNumber, brand, brandModel, model, status,
      carYear, sumDist, carType,
      [field]: value,
    });
  }
};
```

---

## ìƒíƒœ ë³€í™˜

í•œêµ­ì–´ ìƒíƒœë¥¼ ì˜ì–´ë¡œ ë§¤í•‘í•˜ì—¬ ì§€ë„ ì»´í¬ë„ŒíŠ¸ì— ì „ë‹¬í•©ë‹ˆë‹¤.

```typescript
// src/app/detail/page.tsx:44-56
const getEnglishStatus = (
  koreanStatus: string
): 'driving' | 'maintenance' | 'idle' => {
  switch (koreanStatus) {
    case 'ìš´í–‰': return 'driving';
    case 'ìˆ˜ë¦¬': return 'maintenance';
    case 'ëŒ€ê¸°':
    default: return 'idle';
  }
};
```

---

## CarLocationMap

**íŒŒì¼:** [src/components/map/car-location-map.tsx](../src/components/map/car-location-map.tsx)

```typescript
<CarLocationMap
  width="100%"
  height="100%"
  carNumber={carNumber}
  lastLatitude={lastLatitude}
  lastLongitude={lastLongitude}
  status={getEnglishStatus(safeStatus)}
/>
```

---

## ë„¤ë¹„ê²Œì´ì…˜

### ë’¤ë¡œ ê°€ê¸°

```typescript
// src/app/detail/page.tsx:36-38
const goBack = useCallback(() => {
  window.history.back();
}, []);
```

### ì €ì¥ í›„ ì´ë™

```typescript
navigate('/search');
```

---

## ìŠ¤íƒ€ì¼

**íŒŒì¼:** [src/app/detail/detail.module.css](../src/app/detail/detail.module.css)

ì£¼ìš” í´ë˜ìŠ¤:
- `.contentGrid` - 2ì»¬ëŸ¼ ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ
- `.detailCard` - ì •ë³´ ì¹´ë“œ ìŠ¤íƒ€ì¼
- `.mapCard` - ì§€ë„ ì¹´ë“œ ìŠ¤íƒ€ì¼
- `.formGrid` - í¼ ê·¸ë¦¬ë“œ
- `.buttonContainer` - ë²„íŠ¼ ì»¨í…Œì´ë„ˆ

---

## í¸ì§‘ ëª¨ë“œ ì§„ì…

ê²€ìƒ‰ í˜ì´ì§€ì˜ ListBoxì—ì„œ í¸ì§‘ ë²„íŠ¼ í´ë¦­ ì‹œ:

```typescript
// ListBox ì»´í¬ë„ŒíŠ¸ì—ì„œ
setDetailChange(true);
navigate(`/detail?carNumber=${carNumber}`);
```

---

## ê´€ë ¨ ë¬¸ì„œ

- [Module-Search](Module-Search) - ì°¨ëŸ‰ ê²€ìƒ‰ í˜ì´ì§€
- [Module-Maps](Module-Maps) - ì§€ë„ ì»´í¬ë„ŒíŠ¸
- [API-Reference](API-Reference) - ì°¨ëŸ‰ API
